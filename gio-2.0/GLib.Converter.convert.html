<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <meta charset="UTF-8"/>
    <title>GLib.Converter.convert &ndash; gio-2.0 &ndash; Vala Binding Reference</title>
    <link href="../style.css" rel="stylesheet" type="text/css"/><script src="../scripts.js" type="text/javascript">
    </script>
  </head>
  <body>
    <div class="site_header">GLib.Converter.convert &ndash; gio-2.0 Reference Manual</div>
    <div class="site_body">
      <div class="site_navigation">
        <ul class="navi_main">
          <li class="package_index"><a href="../index.html">Packages</a></li>
        </ul>
        <hr class="navi_hr"/>
        <ul class="navi_main">
          <li class="package"><a href="index.htm">gio-2.0</a></li>
        </ul>
        <hr class="navi_hr"/>
        <ul class="navi_main">
          <li class="namespace"><a href="GLib.html">GLib</a></li>
        </ul>
        <hr class="navi_hr"/>
        <ul class="navi_main">
          <li class="interface"><a href="GLib.Converter.html">Converter</a></li>
        </ul>
        <hr class="navi_hr"/>
        <ul class="navi_main">
          <li class="abstract_method">convert</li>
          <li class="abstract_method"><a href="GLib.Converter.reset.html">reset</a></li>
        </ul>
      </div>
      <div class="site_content">
        <h1 class="main_title">convert</h1>
        <hr class="main_hr"/>
        <h2 class="main_title">Description:</h2>
        <div class="main_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">abstract</span> <span class="main_type"><a href="GLib.ConverterResult.html" class="enum">ConverterResult</a></span> <b><span class="abstract_method">convert</span></b> (<span class="main_basic_type"><a href="../glib-2.0/uint8.html" class="struct">uint8</a></span>[] inbuf, <span class="main_basic_type"><a href="../glib-2.0/uint8.html" class="struct">uint8</a></span>[] outbuf, <span class="main_type"><a href="GLib.ConverterFlags.html" class="enum">ConverterFlags</a></span> flags, <span class="main_keyword">out</span> <span class="main_basic_type"><a href="../glib-2.0/size_t.html" class="struct">size_t</a></span> bytes_read, <span class="main_keyword">out</span> <span class="main_basic_type"><a href="../glib-2.0/size_t.html" class="struct">size_t</a></span> bytes_written) <span class="main_keyword">throws</span> <span class="main_type"><a href="../glib-2.0/GLib.Error.html" class="class">Error</a></span>
        </div>
        <div class="description">
          <p>This is the main operation used when converting data.</p>
          <p> It is to be called multiple times in a loop, and each time it will do some work, i.e. producing some output (in <code>outbuf</code>) or 
            consuming some input (from <code>inbuf</code>) or both. If its not possible to do any work an error is returned.</p>
          <p>Note that a single call may not consume all input (or any input at all). Also a call may produce output even if given no input, due to 
            state stored in the converter producing output.</p>
          <p>If any data was either produced or consumed, and then an error happens, then only the successful conversion is reported and the error is 
            returned on the next call.</p>
          <p>A full conversion loop involves calling this method repeatedly, each time giving it new input and space output space. When there is no 
            more input data after the data in <code>inbuf</code>, the flag <span class="main_optional_parameter">g_converter_input_at_end</span> must 
            be set. The loop will be (unless some error happens) returning <span class="main_optional_parameter">g_converter_converted</span> each 
            time until all data is consumed and all output is produced, then <span class="main_optional_parameter">g_converter_finished</span> is 
            returned instead. Note, that <span class="main_optional_parameter">g_converter_finished</span> may be returned even if 
            <span class="main_optional_parameter">g_converter_input_at_end</span> is not set, for instance in a decompression converter where the end 
            of data is detectable from the data (and there might even be other data after the end of the compressed data).</p>
          <p>When some data has successfully been converted <code>bytes_read</code> and is set to the number of bytes read from <code>inbuf</code>, 
            and <code>bytes_written</code> is set to indicate how many bytes was written to <code>outbuf</code>. If there are more data to output or 
            consume (i.e. unless the <span class="main_optional_parameter">g_converter_input_at_end</span> is specified) then 
            <span class="main_optional_parameter">g_converter_converted</span> is returned, and if no more data is to be output then 
            <span class="main_optional_parameter">g_converter_finished</span> is returned.</p>
          <p>On error <span class="main_optional_parameter">g_converter_error</span> is returned and <span class="main_keyword">throws</span> is set 
            accordingly. Some errors need special handling:</p>
          <p><span class="main_optional_parameter">g_io_error_no_space</span> is returned if there is not enough space to write the resulting 
            converted data, the application should call the function again with a larger <code>outbuf</code> to continue.</p>
          <p><span class="main_optional_parameter">g_io_error_partial_input</span> is returned if there is not enough input to fully determine what 
            the conversion should produce, and the <span class="main_optional_parameter">g_converter_input_at_end</span> flag is not set. This happens
             for example with an incomplete multibyte sequence when converting text, or when a regexp matches up to the end of the input (and may 
            match further input). It may also happen when <code>inbuf.length</code> is zero and there is no more data to produce.</p>
          <p>When this happens the application should read more input and then call the function again. If further input shows that there is no more 
            data call the function again with the same data but with the <span class="main_optional_parameter">g_converter_input_at_end</span> flag 
            set. This may cause the conversion to finish as e.g. in the regexp match case (or, to fail again with 
            <span class="main_optional_parameter">g_io_error_partial_input</span> in e.g. a charset conversion where the input is actually partial).
          </p>
          <p>After <span class="abstract_method">convert</span> has returned <span class="main_optional_parameter">g_converter_finished</span> the 
            converter object is in an invalid state where its not allowed to call <span class="abstract_method">convert</span> anymore. At this time 
            you can only free the object or call <a href="GLib.Converter.reset.html" class="abstract_method">reset</a> to reset it to the initial 
            state.</p>
          <p>If the flag <span class="main_optional_parameter">g_converter_flush</span> is set then conversion is modified to try to write out all 
            internal state to the output. The application has to call the function multiple times with the flag set, and when the available input has 
            been consumed and all internal state has been produced then <span class="main_optional_parameter">g_converter_flushed</span> (or 
            <span class="main_optional_parameter">g_converter_finished</span> if really at the end) is returned instead of 
            <span class="main_optional_parameter">g_converter_converted</span>. This is somewhat similar to what happens at the end of the input 
            stream, but done in the middle of the data.</p>
          <p>This has different meanings for different conversions. For instance in a compression converter it would mean that we flush all the 
            compression state into output such that if you uncompress the compressed data you get back all the input data. Doing this may make the 
            final file larger due to padding though. Another example is a regexp conversion, where if you at the end of the flushed data have a match,
             but there is also a potential longer match. In the non-flushed case we would ask for more input, but when flushing we treat this as the 
            end of input and do the match.</p>
          <p>Flushing is not always possible (like if a charset converter flushes at a partial multibyte sequence). Converters are supposed to try to 
            produce as much output as possible and then return an error (typically <span class="main_optional_parameter">g_io_error_partial_input
            </span>).</p>
          <h2 class="main_title">Parameters:</h2>
          <table class="main_parameter_table">
            <tr>
              <td class="main_parameter_table_name">this</td>
              <td>
                <p>a <a href="GLib.Converter.html" class="interface">Converter</a>.</p>
              </td>
            </tr>
            <tr>
              <td class="main_parameter_table_name">inbuf</td>
              <td>
                <p>the buffer  containing the data to convert.</p>
              </td>
            </tr>
            <tr>
              <td class="main_parameter_table_name">outbuf</td>
              <td>
                <p>a buffer to write converted data in.</p>
              </td>
            </tr>
            <tr>
              <td class="main_parameter_table_name">flags</td>
              <td>
                <p>a <a href="GLib.ConverterFlags.html" class="enum">ConverterFlags</a> controlling the conversion details</p>
              </td>
            </tr>
            <tr>
              <td class="main_parameter_table_name">bytes_read</td>
              <td>
                <p>will be set to the number of bytes read from <code>inbuf</code> on success</p>
              </td>
            </tr>
            <tr>
              <td class="main_parameter_table_name">bytes_written</td>
              <td>
                <p>will be set to the number of bytes written to <code>outbuf</code> on success</p>
              </td>
            </tr>
            <tr class="main_parameter_table_unknown_parameter">
              <td class="main_parameter_table_name">inbuf_size</td>
              <td>
                <p>the number of bytes in <code>inbuf</code></p>
              </td>
            </tr>
            <tr class="main_parameter_table_unknown_parameter">
              <td class="main_parameter_table_name">outbuf_size</td>
              <td>
                <p>the number of bytes in <code>outbuf</code>, must be at least one</p>
              </td>
            </tr>
          </table>
          <h2 class="main_title">Returns:</h2>
          <table class="main_parameter_table">
            <tr>
              <td>
                <p>a <a href="GLib.ConverterResult.html" class="enum">ConverterResult</a>, <span class="main_optional_parameter">g_converter_error
                  </span> on error.</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div><br/>
    <div class="site_footer">Generated by <a href="http://www.valadoc.org/">Valadoc</a>
    </div>
  </body>
</html>